<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Градоустройствени единици</title>
  </head>
  <body>
    <!-- Leaflet.js -->
    <link
      rel="stylesheet"
      href="https://unpkg.com/leaflet@1.9.3/dist/leaflet.css"
      integrity="sha256-kLaT2GOSpHechhsozzB+flnD+zUyjE2LlfWPgU04xyI="
      crossorigin=""
    />
    <!-- Make sure you put this AFTER Leaflet's CSS -->
    <script
      src="https://unpkg.com/leaflet@1.9.3/dist/leaflet.js"
      integrity="sha256-WBkoXOwTeyKclOHuWtc+i2uENFpDZ9YPdf5Hf+D7ewM="
      crossorigin=""
    ></script>

    <!-- Leaflet sidebar -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Turbo87/sidebar-v2@v0.4.0/css/leaflet-sidebar.min.css">
    <script type="text/javascript" src="https://cdn.jsdelivr.net/gh/Turbo87/sidebar-v2@v0.4.0/js/leaflet-sidebar.min.js"></script>

    <!-- Mustache -->
    <script
      src="https://www.unpkg.com/mustache@4.2.0/mustache.min.js"
      crossorigin=""
    ></script>

    <!-- Site -->
    <link rel="stylesheet" href="./css/style.css" />

    <div id="sidebar" class="sidebar collapsed">
      <!-- Nav tabs -->
      <div class="sidebar-tabs">
        <ul role="tablist">
          <li>
            <a href="#home" role="tab">i</a>
          </li>
        </ul>
      </div>

      <!-- Tab panes -->
      <div class="sidebar-content">
        <div class="sidebar-pane" id="home">
          <h1 class="sidebar-header">
            Градоустройствени единици
            <span class="sidebar-close"><i class="fa fa-caret-left"></i></span>
          </h1>

          <div id="views"></div>

        </div>
      </div>
    </div>

    <div id="map" class="sidebar-map"></div>

    <script type="module">
      const config = {
        filter: {
          fromLayer: "sofia_rajoni",
          boundsLayer: "sofia_ge",
          labelAttribute: "obns_cyr",
          valueAttribute: "id",
        },
        legend: {
          position: "bottomright",
        },
        views: {
          position: "topright",
          items: [
            {
              label: "Население",
              items: [
                {
                  layer: "sofia_ge",
                  attribute: "gastota_nasel",
                  label: "Гъстота на населението",
                  description: "Данни: ГРАО 2020",
                  legend: {
                    items: [
                      [0, "#fff"],
                      [50, "#cbdefe"],
                      [100, "#afcffe"],
                      [150, "#91bffd"],
                      [250, "#6db0fc"],
                      [350, "#5587c1"],
                      [600, "#283d56"]
                    ],
                  },
                },
                {
                  layer: "sofia_ge",
                  attribute: "grao_nasel",
                  label: "Брой на обитателите в ГЕ",
                  description: "Данни: ГРАО 2020",
                  legend: {
                    items: [
                      [0, "#fff"],
                      [300, "#cbdefe"],
                      [1000, "#afcffe"],
                      [5000, "#91bffd"],
                      [10000, "#6db0fc"],
                      [20000, "#5587c1"],
                      [30000, "#3e618a"],
                      [44000, "#283d56"],
                    ],
                  },
                },
                {
                  layer: "sofia_ge",
                  attribute: "perc_014",
                  label: "Демографска структура -  0-14 години",
                  description: "",
                  legend: {
                    items: [
                      [0, "#fff"],
                      [5, "#afcffe"],
                      [10, "#91bffd"],
                      [15, "#6db0fc"],
                      [20, "#5587c1"],
                      [30, "#283d56"],
                    ],
                  },
                },
                {
                  layer: "sofia_ge",
                  attribute: "perc_1565",
                  label: "Демографска структура - 15-65 години",
                  description: "",
                  legend: {
                    items: [
                      [0, "#fff"],
                      [60, "#afcffe"],
                      [65, "#91bffd"],
                      [70, "#6db0fc"],
                      [80, "#5587c1"],
                      [100, "#283d56"],
                    ],
                  },
                },
                {
                  layer: "sofia_ge",
                  attribute: "perc_nad65",
                  label: "Демографска структура - над 65 години",
                  description: "",
                  legend: {
                    items: [
                      [0, "#fff"],
                      [10, "#cbdefe"],
                      [15, "#91bffd"],
                      [20, "#6db0fc"],
                      [30, "#5587c1"],
                      [42, "#283d56"],
                    ],
                  },
                },
              ],
            },
            {
              label: "Образователна структура",
              items: [
                {
                  layer: "sofia_ge",
                  attribute: "dg_broi",
                  label: "Брой на детските градини и ясли",
                  description: "",
                  legend: {
                    items: [
                      [3, "darkred"],
                      [5, "red"],
                      [10, "lightred"],
                    ],
                  },
                },
              ],
            },
          ],
        },
        mapBounds: [
          [42.75, 23.45],
          [42.6, 23.2],
        ],
        layers: [
          {
            name: "basemap",
            type: "tilelayer",
            source: "http://basemaps.cartocdn.com/light_all/{z}/{x}/{y}.png",
            options: {
              maxZoom: 18,
              minZoom: 11,
              attribution:
                '&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>',
            },
          },
          {
            name: "sofia_ge",
            type: "geojson",
            source: "./data/sofia_ge.geojson",
            filter: {
              attribute: "rajon_id",
              operator: "comma_list"
            },
            options: {
              style: {
                weight: 1,
                opacity: 1,
                color: "#333333",
                fillColor: "#d9ead3",
                fillOpacity: 0.8,
              }
            }
          },
          {
            name: "sofia_rajoni",
            type: "geojson",
            source: "./data/sofia_rajoni.geojson",
            // filter: {
            //   attribute: "id"
            // },
            styleHighlight: {
              weight: 5,
              color: '#f00',
            },
            options: {
              style: {
                weight: 2,
                opacity: 1,
                color: "#000",
                fillOpacity: 0,
              }
            },
          },
        ],
      };

      import init from "./js/g_spot.js";
      init(config);
    </script>
  </body>
</html>
