<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Градоустройствени единици</title>
  </head>
  <body>
    <!-- Leaflet.js -->
    <link
      rel="stylesheet"
      href="https://unpkg.com/leaflet@1.9.3/dist/leaflet.css"
      integrity="sha256-kLaT2GOSpHechhsozzB+flnD+zUyjE2LlfWPgU04xyI="
      crossorigin=""
    />
    <!-- Make sure you put this AFTER Leaflet's CSS -->
    <script
      src="https://unpkg.com/leaflet@1.9.3/dist/leaflet.js"
      integrity="sha256-WBkoXOwTeyKclOHuWtc+i2uENFpDZ9YPdf5Hf+D7ewM="
      crossorigin=""
    ></script>

    <!-- Leaflet sidebar -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Turbo87/sidebar-v2@v0.4.0/css/leaflet-sidebar.min.css">
    <script type="text/javascript" src="https://cdn.jsdelivr.net/gh/Turbo87/sidebar-v2@v0.4.0/js/leaflet-sidebar.min.js"></script>

    <!-- Mustache -->
    <script
      src="https://www.unpkg.com/mustache@4.2.0/mustache.min.js"
      crossorigin=""
    ></script>

    <!-- Site -->
    <link rel="stylesheet" href="./css/style.css" />

    <div id="sidebar" class="sidebar collapsed">
      <!-- Nav tabs -->
      <div class="sidebar-tabs">
        <ul role="tablist">
          <li>
            <a href="#home" role="tab">i</a>
          </li>
        </ul>
      </div>

      <!-- Tab panes -->
      <div class="sidebar-content">
        <div class="sidebar-pane" id="home">
          <h1 class="sidebar-header">
            Градоустройствени единици
            <span class="sidebar-close"><i class="fa fa-caret-left"></i></span>
          </h1>

          <div id="views"></div>

        </div>
      </div>
    </div>

    <div id="map" class="sidebar-map"></div>

    <script type="module">
      const config = {
        filter: {
          fromLayer: "sofia_rajoni",
          boundsLayer: "sofia_ge",
          labelAttribute: "obns_cyr",
          valueAttribute: "id",
        },
        legend: {
          position: "bottomright",
        },
        views: {
          position: "topright",
          items: [
            {
              label: "<b>Население</b>",
              items: [
                {
                  layer: "sofia_ge",
                  attribute: "gastota_nasel",
                  label: "Гъстота на населението",
                  description: "Данни: ГРАО 2020",
                  legend: {
                    items: [
                      [0, "#fff"],
                      [50, "#cbdefe"],
                      [100, "#afcffe"],
                      [150, "#91bffd"],
                      [250, "#6db0fc"],
                      [350, "#5587c1"],
                      [600, "#283d56"]
                    ],
                  },
                },
                {
                  layer: "sofia_ge",
                  attribute: "grao_nasel",
                  label: "Брой на обитателите в ГЕ",
                  description: "Данни: ГРАО 2020",
                  legend: {
                    items: [
                      [0, "#fff"],
                      [300, "#cbdefe"],
                      [1000, "#afcffe"],
                      [5000, "#91bffd"],
                      [10000, "#6db0fc"],
                      [20000, "#5587c1"],
                      [30000, "#3e618a"],
                      [44000, "#283d56"],
                    ],
                  },
                },
                {
                  layer: "sofia_ge",
                  attribute: "perc_014",
                  label: "Демографска структура -  0-14 години",
                  description: "",
                  legend: {
                    items: [
                      [0, "#fff"],
                      [5, "#afcffe"],
                      [10, "#91bffd"],
                      [15, "#6db0fc"],
                      [20, "#5587c1"],
                      [30, "#283d56"],
                    ],
                  },
                },
                {
                  layer: "sofia_ge",
                  attribute: "perc_1565",
                  label: "Демографска структура - 15-65 години",
                  description: "",
                  legend: {
                    items: [
                      [0, "#fff"],
                      [60, "#afcffe"],
                      [65, "#91bffd"],
                      [70, "#6db0fc"],
                      [80, "#5587c1"],
                      [100, "#283d56"],
                    ],
                  },
                },
                {
                  layer: "sofia_ge",
                  attribute: "perc_nad65",
                  label: "Демографска структура - над 65 години",
                  description: "",
                  legend: {
                    items: [
                      [0, "#fff"],
                      [10, "#cbdefe"],
                      [15, "#91bffd"],
                      [20, "#6db0fc"],
                      [30, "#5587c1"],
                      [42, "#283d56"],
                    ],
                  },
                },
                {
                  layer: "sofia_ge",
                  attribute: "pr2030",
                  label: "Реалистичен вариант от прогноза за населението - 2030 година",
                  description: "",
                  legend: {
                    items: [
                      [0, "#fff"],
                      [300, "#cbdefe"],
                      [1000, "#afcffe"],
                      [5000, "#91bffd"],
                      [10000, "#6db0fc"],
                      [20000, "#5587c1"],
                      [44000, "#3e618a"],
                      [65000, "#283d56"],
                    ],
                  },
                },
                {
                  layer: "sofia_ge",
                  attribute: "pr2040",
                  label: "Реалистичен вариант от прогноза за населението - 2040 година",
                  description: "",
                  legend: {
                    items: [
                      [0, "#fff"],
                      [300, "#cbdefe"],
                      [1000, "#afcffe"],
                      [5000, "#91bffd"],
                      [10000, "#6db0fc"],
                      [20000, "#5587c1"],
                      [44000, "#3e618a"],
                      [67000, "#283d56"],
                    ],
                  },
                },
                {
                  layer: "sofia_ge",
                  attribute: "pr2050",
                  label: "Реалистичен вариант от прогноза за населението - 2050 година",
                  description: "",
                  legend: {
                    items: [
                      [0, "#fff"],
                      [300, "#cbdefe"],
                      [1000, "#afcffe"],
                      [5000, "#91bffd"],
                      [10000, "#6db0fc"],
                      [20000, "#5587c1"],
                      [44000, "#3e618a"],
                      [70000, "#283d56"],
                    ],
                  },
                },
              ],
            },
            {
              label: "<b>Селищна мрежа</b>",
              items: [
                {
                  layer: "sofia_ge",
                  attribute: "zastr_intenz",
                  label: "Брутна интензивност на застрояване - коефициент",
                  description: "",
                  legend: {
                    items: [
                      [0.2189, "#cbdefe"],
                      [0.6264, "#91bffd"],
                      [1.0942, "#6db0fc"],
                      [1.6623, "#5587c1"],
                      [2.5968, "#283d56"],
                    ],
                  },
                },
                {
                  layer: "sofia_ge",
                  attribute: "zastr_plyt",
                  label: "Брутна плътност на застрояване",
                  description: "",
                  legend: {
                    items: [
                      [0.0372, "#cbdefe"],
                      [0.1042, "#91bffd"],
                      [0.1804, "#6db0fc"],
                      [0.2862, "#5587c1"],
                      [0.434, "#283d56"],
                    ],
                  },
                },
                {
                  layer: "sofia_ge",
                  attribute: "zastr_sklyuch",
                  label: "Брутна сключеност на застрояване - коефициент",
                  description: "",
                  legend: {
                    items: [
                      [0.04828, "#cbdefe"],
                      [0.15122, "#91bffd"],
                      [0.2929, "#6db0fc"],
                      [0.46875, "#5587c1"],
                      [0.7554, "#283d56"],
                    ],
                  },
                },
                {
                  layer: "sofia_ge",
                  attribute: "adm_rzp",
                  label: "Дял на административните РЗП",
                  description: "",
                  legend: {
                    items: [
                      [0.01, "#fff"],
                      [0.2, "#cbdefe"],
                      [0.4, "#91bffd"],
                      [0.6, "#6db0fc"],
                      [0.8, "#5587c1"],
                      [0.9285, "#283d56"],
                    ],
                  },
                },
                {
                  layer: "sofia_ge",
                  attribute: "jil_rzp",
                  label: "Дял на жилищните РЗП",
                  description: "",
                  legend: {
                    items: [
                      [0.01, "#fff"],
                      [0.2, "#cbdefe"],
                      [0.4, "#91bffd"],
                      [0.6, "#6db0fc"],
                      [0.8, "#5587c1"],
                      [1, "#283d56"],
                    ],
                  },
                },
                {
                  layer: "sofia_ge",
                  attribute: "proizv_rzp",
                  label: "Дял на производствените РЗП",
                  description: "",
                  legend: {
                    items: [
                      [0.01, "#fff"],
                      [0.2, "#cbdefe"],
                      [0.4, "#91bffd"],
                      [0.6, "#6db0fc"],
                      [0.8, "#5587c1"],
                      [1, "#283d56"],
                    ],
                  },
                },
                {
                  layer: "sofia_ge",
                  attribute: "targov_rzp",
                  label: "Дял на търговските РЗП",
                  description: "",
                  legend: {
                    items: [
                      [0.01, "#fff"],
                      [0.2, "#cbdefe"],
                      [0.4, "#91bffd"],
                      [0.6, "#6db0fc"],
                      [0.8, "#5587c1"],
                      [1, "#283d56"],
                    ],
                  },
                },
                {
                  layer: "sofia_ge",
                  attribute: "zastr_potenc",
                  label: "Потенциал на застрояване от ОУП",
                  description: "",
                  legend: {
                    items: [
                      [1, "#fff", "няма"],
                      [2, "#6db0fc", "има"],
                      [3, "#283d56", "има според далекоперспективните зони"],
                    ],
                  },
                },
                {
                  layer: "sofia_ge",
                  attribute: "multi_norm",
                  label: "Мултифункционалност",
                  description: "",
                  legend: {
                    items: [
                      [0.1, "#fff"],
                      [0.333, "#cbdefe"],
                      [0.952, "#91bffd"],
                      [2.015, "#6db0fc"],
                      [3.707, "#5587c1"],
                      [5.7783, "#283d56"],
                    ],
                  },
                },
                {
                  layer: "sofia_ge",
                  attribute: "tipologia",
                  label: "Преобладаващо функционално зониране от ОУП",
                  description: "",
                  legend: {
                    items: [
                      ["Жс", "#e1ae8f"],
                      ["Жв", "#e1ae8f"],
                      ["Жг", "#e1ae8f"],
                      ["Жк", "#e1ae8f"],
                      ["Жм", "#e1ae8f"],
                      ["Жмд", "#e1ae8f"],
                      ["СмфГ, Ц", "#f9aaaa"],
                      ["Сс", "#f9f4e3"],
                      ["Г", "#c6d1be"],
                      ["Зс, В", "#e1eed9"],
                      ["Смфд, СмфП, Пс, Н, Итс", "#f3ddf4"],
                    ],
                  },
                },
                {
                  layer: "sofia_ge",
                  attribute: "preobl_et",
                  label: "Преобладаваща етажност",
                  description: "",
                  legend: {
                    items: [
                      ["0", "#fff", "ГЕ без застрояване"],
                      ["до 3 етажа", "#cbdefe", "до 3 етажа"],
                      ["от 4 до 6 етажа", "#6db0fc", "от 4 до 6 етажа"],
                      ["от 7 до 10 етажа", "#283d56", "от 7 до 10 етажа"],
                    ],
                  },
                },
                {
                  layer: "sofia_ge",
                  attribute: "sr_etaj",
                  label: "Средна етажност",
                  description: "",
                  legend: {
                    items: [
                      [0, "#fff", "ГЕ без застрояване"],
                      [2, "#cbdefe", "1 - 2 етажа"],
                      [3, "#91bffd", "2 - 3 етажа"],
                      [4, "#6db0fc", "3 - 4 етажа"],
                      [5, "#5587c1", "4 - 5 етажа"],
                      [6.24, "#283d56", "5 - 6,5 етажа"],
                    ],
                  },
                },
                {
                  layer: "sofia_ge",
                  attribute: "razr_jil_2010",
                  label: "Издадени разрешения за строеж след 2010 г.",
                  description: "",
                  legend: {
                    items: [
                      [0, "#fff", "0 броя"],
                      [10, "#cbdefe", "0 - 10 броя"],
                      [20, "#91bffd", "10 - 20 броя"],
                      [30, "#6db0fc", "20 - 30 броя"],
                      [60, "#5587c1", "30 - 60 броя"],
                      [117, "#283d56", "60 - 120 броя"],
                    ],
                  },
                },
              ],
            },
            {              
              label: "<b>Жилища</b>",
              items: [
                {
                  layer: "sofia_ge",
                  attribute: "gastota_nasel",
                  label: "Гъстота на населението",
                  description: "Данни: ГРАО 2020",
                  legend: {
                    items: [
                      [0, "#fff"],
                      [50, "#cbdefe"],
                      [100, "#afcffe"],
                      [150, "#91bffd"],
                      [250, "#6db0fc"],
                      [350, "#5587c1"],
                      [600, "#283d56"]
                    ],
                  },
                },
              ]
            },
            {              
              label: "<b>Канализация</b>",
              items: [
                {
                  layer: "sofia_ge",
                  attribute: "gastota_nasel",
                  label: "Гъстота на населението",
                  description: "Данни: ГРАО 2020",
                  legend: {
                    items: [
                      [0, "#fff"],
                      [50, "#cbdefe"],
                      [100, "#afcffe"],
                      [150, "#91bffd"],
                      [250, "#6db0fc"],
                      [350, "#5587c1"],
                      [600, "#283d56"]
                    ],
                  },
                },
              ]
            },
            {              
              label: "<b>Енергия</b>",
              items: [
                {
                  layer: "sofia_ge",
                  attribute: "gastota_nasel",
                  label: "Гъстота на населението",
                  description: "Данни: ГРАО 2020",
                  legend: {
                    items: [
                      [0, "#fff"],
                      [50, "#cbdefe"],
                      [100, "#afcffe"],
                      [150, "#91bffd"],
                      [250, "#6db0fc"],
                      [350, "#5587c1"],
                      [600, "#283d56"]
                    ],
                  },
                },
              ]
            },
            {              
              label: "<b>Транспорт</b>",
              items: [
                {
                  layer: "sofia_ge",
                  attribute: "gastota_nasel",
                  label: "Гъстота на населението",
                  description: "Данни: ГРАО 2020",
                  legend: {
                    items: [
                      [0, "#fff"],
                      [50, "#cbdefe"],
                      [100, "#afcffe"],
                      [150, "#91bffd"],
                      [250, "#6db0fc"],
                      [350, "#5587c1"],
                      [600, "#283d56"]
                    ],
                  },
                },
              ]
            },
            {              
              label: "<b>Здравна инфраструктура и заболеваемост</b>",
              items: [
                {
                  layer: "sofia_ge",
                  attribute: "gastota_nasel",
                  label: "Гъстота на населението",
                  description: "Данни: ГРАО 2020",
                  legend: {
                    items: [
                      [0, "#fff"],
                      [50, "#cbdefe"],
                      [100, "#afcffe"],
                      [150, "#91bffd"],
                      [250, "#6db0fc"],
                      [350, "#5587c1"],
                      [600, "#283d56"]
                    ],
                  },
                },
              ]
            },
            {              
              label: "<b>Образователна инфраструктура</b>",
              items: [
                {
                  layer: "sofia_ge",
                  attribute: "gastota_nasel",
                  label: "Гъстота на населението",
                  description: "Данни: ГРАО 2020",
                  legend: {
                    items: [
                      [0, "#fff"],
                      [50, "#cbdefe"],
                      [100, "#afcffe"],
                      [150, "#91bffd"],
                      [250, "#6db0fc"],
                      [350, "#5587c1"],
                      [600, "#283d56"]
                    ],
                  },
                },
              ]
            },
            {              
              label: "<b>Мрежата от социални услуги</b>",
              items: [
                {
                  layer: "sofia_ge",
                  attribute: "gastota_nasel",
                  label: "Гъстота на населението",
                  description: "Данни: ГРАО 2020",
                  legend: {
                    items: [
                      [0, "#fff"],
                      [50, "#cbdefe"],
                      [100, "#afcffe"],
                      [150, "#91bffd"],
                      [250, "#6db0fc"],
                      [350, "#5587c1"],
                      [600, "#283d56"]
                    ],
                  },
                },
              ]
            },
            {              
              label: "<b>Култура и културна инфраструктура</b>",
              items: [
                {
                  layer: "sofia_ge",
                  attribute: "gastota_nasel",
                  label: "Гъстота на населението",
                  description: "Данни: ГРАО 2020",
                  legend: {
                    items: [
                      [0, "#fff"],
                      [50, "#cbdefe"],
                      [100, "#afcffe"],
                      [150, "#91bffd"],
                      [250, "#6db0fc"],
                      [350, "#5587c1"],
                      [600, "#283d56"]
                    ],
                  },
                },
              ]
            },
            {              
              label: "<b>Идентичност и културно наследство</b>",
              items: [
                {
                  layer: "sofia_ge",
                  attribute: "gastota_nasel",
                  label: "Гъстота на населението",
                  description: "Данни: ГРАО 2020",
                  legend: {
                    items: [
                      [0, "#fff"],
                      [50, "#cbdefe"],
                      [100, "#afcffe"],
                      [150, "#91bffd"],
                      [250, "#6db0fc"],
                      [350, "#5587c1"],
                      [600, "#283d56"]
                    ],
                  },
                },
              ]
            },
            {              
              label: "<b>Въздух</b>",
              items: [
                {
                  layer: "sofia_ge",
                  attribute: "gastota_nasel",
                  label: "Гъстота на населението",
                  description: "Данни: ГРАО 2020",
                  legend: {
                    items: [
                      [0, "#fff"],
                      [50, "#cbdefe"],
                      [100, "#afcffe"],
                      [150, "#91bffd"],
                      [250, "#6db0fc"],
                      [350, "#5587c1"],
                      [600, "#283d56"]
                    ],
                  },
                },
              ]
            },
            {              
              label: "<b>Води</b>",
              items: [
                {
                  layer: "sofia_ge",
                  attribute: "gastota_nasel",
                  label: "Гъстота на населението",
                  description: "Данни: ГРАО 2020",
                  legend: {
                    items: [
                      [0, "#fff"],
                      [50, "#cbdefe"],
                      [100, "#afcffe"],
                      [150, "#91bffd"],
                      [250, "#6db0fc"],
                      [350, "#5587c1"],
                      [600, "#283d56"]
                    ],
                  },
                },
              ]
            },
            {              
              label: "<b>Почви</b>",
              items: [
                {
                  layer: "sofia_ge",
                  attribute: "gastota_nasel",
                  label: "Гъстота на населението",
                  description: "Данни: ГРАО 2020",
                  legend: {
                    items: [
                      [0, "#fff"],
                      [50, "#cbdefe"],
                      [100, "#afcffe"],
                      [150, "#91bffd"],
                      [250, "#6db0fc"],
                      [350, "#5587c1"],
                      [600, "#283d56"]
                    ],
                  },
                },
              ]
            },
            {              
              label: "<b>Зелена система</b>",
              items: [
                {
                  layer: "sofia_ge",
                  attribute: "gastota_nasel",
                  label: "Гъстота на населението",
                  description: "Данни: ГРАО 2020",
                  legend: {
                    items: [
                      [0, "#fff"],
                      [50, "#cbdefe"],
                      [100, "#afcffe"],
                      [150, "#91bffd"],
                      [250, "#6db0fc"],
                      [350, "#5587c1"],
                      [600, "#283d56"]
                    ],
                  },
                },
              ]
            },
          ],
        },
        mapBounds: [
          [42.75, 23.45],
          [42.6, 23.2],
        ],
        layers: [
          {
            name: "basemap",
            type: "tilelayer",
            source: "http://basemaps.cartocdn.com/light_all/{z}/{x}/{y}.png",
            options: {
              maxZoom: 18,
              minZoom: 11,
              attribution:
                '&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>',
            },
          },
          {
            name: "sofia_ge",
            type: "geojson",
            source: "./data/sofia_ge.geojson",
            filter: {
              attribute: "rajon_id",
              operator: "comma_list"
            },
            options: {
              style: {
                weight: 1,
                opacity: 1,
                color: "#999999",
                fillColor: "#d9ead3",
                fillOpacity: 0.7,
              }
            }
          },
          {
            name: "sofia_rajoni",
            type: "geojson",
            source: "./data/sofia_rajoni.geojson",
            // filter: {
            //   attribute: "id"
            // },
            styleHighlight: {
              weight: 5,
              color: '#f00',
            },
            options: {
              style: {
                weight: 2,
                opacity: 1,
                color: "#000",
                fillOpacity: 0,
              }
            },
          },
        ],
      };

      import init from "./js/g_spot.js";
      init(config);
    </script>
  </body>
</html>
