<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Градоустройствени единици</title>
  </head>
  <body>
    <!-- Leaflet.js -->
    <link
      rel="stylesheet"
      href="https://unpkg.com/leaflet@1.9.3/dist/leaflet.css"
      integrity="sha256-kLaT2GOSpHechhsozzB+flnD+zUyjE2LlfWPgU04xyI="
      crossorigin=""
    />
    <!-- Make sure you put this AFTER Leaflet's CSS -->
    <script
      src="https://unpkg.com/leaflet@1.9.3/dist/leaflet.js"
      integrity="sha256-WBkoXOwTeyKclOHuWtc+i2uENFpDZ9YPdf5Hf+D7ewM="
      crossorigin=""
    ></script>

    <!-- Leaflet sidebar -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Turbo87/sidebar-v2@v0.4.0/css/leaflet-sidebar.min.css">
    <script type="text/javascript" src="https://cdn.jsdelivr.net/gh/Turbo87/sidebar-v2@v0.4.0/js/leaflet-sidebar.min.js"></script>

    <!-- Mustache -->
    <script
      src="https://www.unpkg.com/mustache@4.2.0/mustache.min.js"
      crossorigin=""
    ></script>

    <!-- Site -->
    <link rel="stylesheet" href="./css/style.css" />

    <div id="sidebar" class="sidebar collapsed">
      <!-- Nav tabs -->
      <div class="sidebar-tabs">
        <ul role="tablist">
          <li>
            <a href="#home" role="tab">i</a>
          </li>
        </ul>
      </div>

      <!-- Tab panes -->
      <div class="sidebar-content">
        <div class="sidebar-pane" id="home">
          <h1 class="sidebar-header">
            Градоустройствени единици
            <span class="sidebar-close"><i class="fa fa-caret-left"></i></span>
          </h1>

          <div id="views"></div>

        </div>
      </div>
    </div>

    <div id="map" class="sidebar-map"></div>

    <script type="module">
      const config = {
        filter: {
          fromLayer: "sofia_rajoni",
          boundsLayer: "sofia_rajoni",
          labelAttribute: "obns_cyr",
          valueAttribute: "obns_num",
        },
        legend: {
          position: "bottomright",
        },
        views: {
          position: "topright",
          items: [
            {
              label: "Население",
              items: [
                {
                  layer: "sofia_ge",
                  attribute: "gastota_nasel",
                  label: "Гъстота на населението",
                  description: "Данни: ГРАО 2020",
                  legend: {
                    items: [
                      [10, "yellow"],
                      [50, "orange"],
                      [100, "pink"],
                      [200, "red"],
                      [500, "brown"],
                      [1000, "brown"],
                    ],
                  },
                },
                {
                  layer: "sofia_ge",
                  attribute: "grao_nasel",
                  label: "Брой на обитатели",
                  description: "Данни: ГРАО 2020",
                  legend: {
                    items: [
                      [1000, "darkblue"],
                      [10000, "royalblue"],
                      [100000, "lightblue"],
                    ],
                  },
                },
              ],
            },
            {
              label: "Образователна структура",
              items: [
                {
                  layer: "sofia_ge",
                  attribute: "dg_broi",
                  label: "Брой на детските градини и ясли",
                  description: "",
                  legend: {
                    items: [
                      [3, "darkred"],
                      [5, "red"],
                      [10, "lightred"],
                    ],
                  },
                },
              ],
            },
          ],
        },
        mapBounds: [
          [42.75, 23.45],
          [42.6, 23.2],
        ],
        layers: [
          {
            name: "basemap",
            type: "tilelayer",
            source: "https://tile.openstreetmap.org/{z}/{x}/{y}.png",
            options: {
              maxZoom: 18,
              minZoom: 11,
              attribution:
                '&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>',
            },
          },
          {
            name: "sofia_rajoni",
            type: "geojson",
            source: "./data/sofia_rajoni.geojson",
            filter: {
              attribute: "obns_num"
            },
            options: {
              style: {
                weight: 2,
                opacity: 1,
                color: "#000",
                fillOpacity: 0,
              }
            },
          },
          {
            name: "sofia_ge",
            type: "geojson",
            source: "./data/sofia_ge.geojson",
            filter: {
              attribute: "obns_id",
              operator: "comma_list"
            },
            styleHighlight: {
              weight: 5,
              color: '#f00',
            },
            options: {
              style: {
                weight: 1,
                opacity: 1,
                color: "#f00",
                fillColor: "#0f0",
                fillOpacity: 0.5,
              }
            },
            popupTmpl: `
              {{f.properties.regname}}, {{f.properties.rajon}}

              <table>
                <tr>
                  <td>
                    Население: {{f.properties.grao_nasel}}
                  </td>
                </tr>
              </table>
            `
          },
        ],
      };

      import init from "./js/g_spot.js";
      init(config);
    </script>
  </body>
</html>
